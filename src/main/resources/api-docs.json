{
  "info": {
    "title": "Microservice 3 - Service Demandes Transport API",
    "description": "API de gestion des demandes de transport pour le système de transport",
    "version": "1.0.0",
    "baseUrl": "/api/v1"
  },
  "endpoints": [
    {
      "method": "POST",
      "path": "/demandes",
      "summary": "Créer une nouvelle demande de transport",
      "description": "Crée une nouvelle demande de transport pour le client authentifié avec calcul automatique du devis",
      "authentication": "Bearer JWT Token",
      "requestBody": {
        "volume": 25.5,
        "natureMarchandise": "Matériaux de construction",
        "dateDepart": "2025-12-15T08:00:00",
        "adresseDepart": "123 Rue Mohammed V, Casablanca, Maroc",
        "adresseDestination": "456 Avenue Hassan II, Rabat, Maroc"
      },
      "testExamples": {
        "powershell": "$headers = @{'Content-Type'='application/json'; 'Authorization'='Bearer YOUR_JWT_TOKEN'}; $body = '{\"volume\":25.5,\"natureMarchandise\":\"Matériaux de construction\",\"dateDepart\":\"2025-12-15T08:00:00\",\"adresseDepart\":\"123 Rue Mohammed V, Casablanca\",\"adresseDestination\":\"456 Avenue Hassan II, Rabat\"}'; Invoke-RestMethod -Uri 'http://localhost:8083/api/v1/demandes' -Method POST -Headers $headers -Body $body",
        "curl": "curl -X POST 'http://localhost:8083/api/v1/demandes' -H 'Content-Type: application/json' -H 'Authorization: Bearer YOUR_JWT_TOKEN' -d '{\"volume\":25.5,\"natureMarchandise\":\"Matériaux de construction\",\"dateDepart\":\"2025-12-15T08:00:00\",\"adresseDepart\":\"123 Rue Mohammed V, Casablanca\",\"adresseDestination\":\"456 Avenue Hassan II, Rabat\"}'",
        "fetch": "fetch('http://localhost:8083/api/v1/demandes', {method:'POST', headers:{'Content-Type':'application/json','Authorization':'Bearer YOUR_JWT_TOKEN'}, body:JSON.stringify({volume:25.5,natureMarchandise:'Matériaux de construction',dateDepart:'2025-12-15T08:00:00',adresseDepart:'123 Rue Mohammed V, Casablanca',adresseDestination:'456 Avenue Hassan II, Rabat'})}).then(r=>r.json()).then(console.log)"
      }
    },
    {
      "method": "GET",
      "path": "/demandes",
      "summary": "Récupérer toutes les demandes du client",
      "description": "Retourne la liste de toutes les demandes de transport du client authentifié",
      "authentication": "Bearer JWT Token",
      "testExamples": {
        "powershell": "Invoke-RestMethod -Uri 'http://localhost:8083/api/v1/demandes' -Method GET -Headers @{'Authorization'='Bearer YOUR_JWT_TOKEN'}",
        "curl": "curl -X GET 'http://localhost:8083/api/v1/demandes' -H 'Authorization: Bearer YOUR_JWT_TOKEN'",
        "fetch": "fetch('http://localhost:8083/api/v1/demandes', {headers:{'Authorization':'Bearer YOUR_JWT_TOKEN'}}).then(r=>r.json()).then(console.log)"
      }
    },
    {
      "method": "GET",
      "path": "/demandes/{id}",
      "summary": "Récupérer une demande par ID",
      "description": "Retourne les détails complets d'une demande spécifique",
      "authentication": "Bearer JWT Token",
      "parameters": [
        {
          "name": "id",
          "type": "integer",
          "required": true,
          "description": "ID de la demande"
        }
      ],
      "testExamples": {
        "powershell": "Invoke-RestMethod -Uri 'http://localhost:8083/api/v1/demandes/1' -Method GET -Headers @{'Authorization'='Bearer YOUR_JWT_TOKEN'}",
        "curl": "curl -X GET 'http://localhost:8083/api/v1/demandes/1' -H 'Authorization: Bearer YOUR_JWT_TOKEN'",
        "fetch": "fetch('http://localhost:8083/api/v1/demandes/1', {headers:{'Authorization':'Bearer YOUR_JWT_TOKEN'}}).then(r=>r.json()).then(console.log)"
      }
    },
    {
      "method": "PUT",
      "path": "/demandes/{id}/validation",
      "summary": "Valider une demande",
      "description": "Le client confirme qu'il accepte le devis de la demande",
      "authentication": "Bearer JWT Token",
      "parameters": [
        {
          "name": "id",
          "type": "integer",
          "required": true,
          "description": "ID de la demande à valider"
        }
      ],
      "testExamples": {
        "powershell": "Invoke-RestMethod -Uri 'http://localhost:8083/api/v1/demandes/1/validation' -Method PUT -Headers @{'Authorization'='Bearer YOUR_JWT_TOKEN'}",
        "curl": "curl -X PUT 'http://localhost:8083/api/v1/demandes/1/validation' -H 'Authorization: Bearer YOUR_JWT_TOKEN'",
        "fetch": "fetch('http://localhost:8083/api/v1/demandes/1/validation', {method:'PUT', headers:{'Authorization':'Bearer YOUR_JWT_TOKEN'}}).then(r=>r.json()).then(console.log)"
      }
    },
    {
      "method": "PUT",
      "path": "/demandes/{id}/paiement",
      "summary": "Mettre à jour le statut de paiement",
      "description": "Webhook appelé par le Service Paiements pour mettre à jour le statut de paiement d'une demande",
      "authentication": "None",
      "parameters": [
        {
          "name": "id",
          "type": "integer",
          "required": true,
          "description": "ID de la demande"
        }
      ],
      "requestBody": {
        "nouveauStatut": "PAYEE"
      },
      "testExamples": {
        "powershell": "$headers = @{'Content-Type'='application/json'}; $body = '{\"nouveauStatut\":\"PAYEE\"}'; Invoke-RestMethod -Uri 'http://localhost:8083/api/v1/demandes/1/paiement' -Method PUT -Headers $headers -Body $body",
        "curl": "curl -X PUT 'http://localhost:8083/api/v1/demandes/1/paiement' -H 'Content-Type: application/json' -d '{\"nouveauStatut\":\"PAYEE\"}'",
        "fetch": "fetch('http://localhost:8083/api/v1/demandes/1/paiement', {method:'PUT', headers:{'Content-Type':'application/json'}, body:JSON.stringify({nouveauStatut:'PAYEE'})}).then(r=>r.json()).then(console.log)"
      }
    }
  ],
  "schemas": {
    "DemandeRequest": {
      "type": "object",
      "properties": {
        "volume": "number - Volume de la marchandise (doit être positif)",
        "natureMarchandise": "string - Nature de la marchandise à transporter",
        "dateDepart": "datetime - Date et heure de départ (doit être dans le futur)",
        "adresseDepart": "string - Adresse de départ",
        "adresseDestination": "string - Adresse de destination"
      }
    },
    "DemandeResponse": {
      "type": "object",
      "properties": {
        "id": "integer - Identifiant unique de la demande",
        "clientId": "integer - ID du client",
        "volume": "number - Volume de la marchandise",
        "natureMarchandise": "string - Nature de la marchandise",
        "dateDepart": "datetime - Date et heure de départ",
        "adresseDepart": "string - Adresse de départ",
        "adresseDestination": "string - Adresse de destination",
        "statutValidation": "string - Statut de validation (EN_ATTENTE, VALIDEE, REFUSEE)",
        "statutPaiement": "string - Statut de paiement (EN_ATTENTE, PAYEE, REMBOURSEE)",
        "devisEstime": "decimal - Devis estimé en MAD",
        "itineraireAssocieId": "integer - ID de l'itinéraire associé",
        "groupeId": "integer - ID du groupe de transport",
        "dateCreation": "datetime - Date de création de la demande",
        "dateModification": "datetime - Date de dernière modification"
      }
    },
    "PaiementStatusUpdate": {
      "type": "object",
      "properties": {
        "nouveauStatut": "string - Nouveau statut de paiement (EN_ATTENTE, PAYEE, REMBOURSEE)"
      }
    }
  }
}

